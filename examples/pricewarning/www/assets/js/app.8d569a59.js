(function(t){function e(e){for(var n,a,o=e[0],c=e[1],h=e[2],u=0,d=[];u<o.length;u++)a=o[u],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&d.push(r[a][0]),r[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(d.length)d.shift()();return s.push.apply(s,h||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],n=!0,o=1;o<i.length;o++){var c=i[o];0!==r[c]&&(n=!1)}n&&(s.splice(e--,1),t=a(a.s=i[0]))}return t}var n={},r={app:0},s=[];function a(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=n,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var h=0;h<o.length;h++)e(o[h]);var l=c;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0fd9":function(t,e,i){"use strict";var n=i("2bea"),r=i.n(n);r.a},"1cde":function(t,e,i){},"22eb":function(t,e,i){"use strict";var n=i("27e0"),r=i.n(n);r.a},"27e0":function(t,e,i){},"29f3":function(t,e,i){"use strict";var n=i("80a6"),r=i.n(n);r.a},"2bea":function(t,e,i){},"351d":function(t,e,i){},3838:function(t,e,i){},4963:function(t,e,i){},"551b":function(t,e,i){},"55b5":function(t,e,i){"use strict";var n=i("1cde"),r=i.n(n);r.a},"56d7":function(t,e,i){"use strict";i.r(e);i("fca0"),i("c5f6"),i("cadf"),i("551c"),i("f751"),i("097d");var n=i("2b0e"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Layout",{attrs:{id:"shinny-app"}},[i("Content",{staticClass:"content"},[i("Split",{attrs:{mode:"vertical"},model:{value:t.$root.appSplit,callback:function(e){t.$set(t.$root,"appSplit",e)},expression:"$root.appSplit"}},[i("div",{staticClass:"split-pane",attrs:{slot:"top"},slot:"top"},[i("router-view",{attrs:{name:"quotes"}})],1),i("div",{staticClass:"split-horizontal",attrs:{slot:"trigger"},slot:"trigger"},[i("div",{staticClass:"split-horizontal-dots"},[i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"})])]),i("div",{staticClass:"split-pane",attrs:{slot:"bottom"},slot:"bottom"},[i("router-view",{attrs:{name:"user"}})],1)])],1)],1)},s=[],a=(i("7f7f"),{data:function(){return{isShowSettingModel:!1}},methods:{showSettingModel:function(){},onClickOk:function(){console.log("onClickOk")},onClickCancel:function(){console.log("onClickCancel")},onVisibleChange:function(t){console.log(t)}},computed:{isShowBackBtn:function(){return"charts"===this.$route.name}},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){this.$on("tqsdk:notify",(function(t){"INFO"===t.level?"SETTLEMENT"===t.type?this.$store.commit("SET_SETTLEMENT",t):"MESSAGE"===t.type&&this.$Message.info(t.content):"WARNING"!==t.level&&"ERROR"!==t.level||this.$Message.error(t.content)}))},beforeUpdate:function(){},updated:function(){},activated:function(){},deactivated:function(){},beforeDestroy:function(){},destroyed:function(){},errorCaptured:function(t,e,i){return console.error("App.errorCaptured",t,e,i),!1}}),o=a,c=(i("5c0b"),i("2877")),h=Object(c["a"])(o,r,s,!1,null,null,null),l=h.exports,u=i("8c4f"),d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"quotes-container",staticStyle:{height:"100%"}},[i("SplitLeftRight",{attrs:{split:.8}},[i("template",{slot:"left"},[i("div",{staticClass:"top-content"},[i("ButtonsLine",{attrs:{tags:t.tags,defaultTag:t.defaultTag},on:{change:t.handlerChangeTag}})],1),i("div",{staticClass:"bottom-content",staticStyle:{top:"28px"}},[i("table-quotes",{attrs:{contentList:t.quotesList,tableCol:t.quotesTableRow,rootPath:t.rootPath}})],1)]),i("template",{slot:"right"},[i("div",{staticClass:"top-content"},[i("quote-info",{attrs:{instrumentId:t.instrumentId}})],1),i("div",{staticClass:"bottom-content",staticStyle:{top:"220px"}},[i("ticks-list",{attrs:{instrumentId:t.instrumentId}})],1)])],2)],1)},m=[],p=(i("8e6e"),i("ac6a"),i("456d"),i("a481"),i("bd86")),f=i("2f62"),_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tq-table-container",style:{height:"100%"},on:{scroll:t.handleScroll}},[i("table",{attrs:{id:"QuotesTable"}},[i("thead",[i("tr",t._l(t.tableCol,(function(e,n){return i("td",{key:n},[i("div",{style:t.computeStyleObj(e)},[t._v(t._s(e["name"]))])])})),0)]),i("tbody",t._l(t.contentList,(function(e){return i("table-row",{key:e,class:{selected:e===t.selectedSymbol},attrs:{symbol:e,path:t.rootPath+e+"/",tableCol:t.tableCol},on:{rowClick:t.rowClick,rowDbClick:t.rowDbClick}})})),1)])])},g=[],v=(i("6762"),i("2fdb"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{on:{click:t.handlerClick,dblclick:t.handlerDbClick}},[i("td",[i("div",[t._v(t._s(t.ins_id))])]),t._l(t.tableCol,(function(e,n){return n>0?i("td",{key:n,class:t.classNameStr(e)},[i("div",{staticClass:"data-content",style:t.styleObj(e),attrs:{"data-content":t.formatter(e)}})]):t._e()}))],2)}),b=[],y=(i("28a5"),i("4917"),{data:function(){return{priceDecs:0,priceTick:1,ins_id:"",ins_name:"",quote:{}}},components:{},props:{tableCol:{type:Array},symbol:{type:String},path:{type:String}},beforeMount:function(){this.quote=this.$tqsdk.get_quote(this.symbol),this.priceDecs=this.quote.price_decs,this.priceTick=this.quote.price_tick,this.ins_name=this.quote.ins_name;var t=this.symbol.match(/KQ\.[im]@([a-zA-Z]+)\.([a-zA-Z]+)/);t&&t[2]?("FUTURE_CONT"===this.quote.class&&(this.ins_id=t[2]+"主连 ("+this.quote.underlying_symbol.split(".")[1]+")"),"FUTURE_INDEX"===this.quote.class&&(this.ins_id=t[2]+"指数")):this.ins_id=this.quote.ins_id},mounted:function(){this.$on("tqsdk:rtn_data",(function(){this.$tqsdk.is_changed(this.quote)&&this.$forceUpdate()}))},methods:{classNameStr:function(t){return"function"===typeof t["className"]?this.quote?t["className"](this.quote):"":t["className"]},styleObj:function(t){var e={};return t["width"]&&(e["width"]=t["width"]+"px"),e},formatter:function(t){return t.formatter?t.formatter(this.quote):this.quote[t.prop]},handlerClick:function(){this.$emit("rowClick",this.quote)},handlerDbClick:function(){this.$emit("rowDbClick",this.quote)},handlerRowContextmenu:function(t){t.stopPropagation(),t.preventDefault(),this.$emit("rowContextmenu",this.quote)}}}),w=y,k=Object(c["a"])(w,v,b,!1,null,null,null),C=k.exports,S={data:function(){return{selectedSymbol:""}},components:{TableRow:C},props:{height:{type:String},tableCol:{type:Array},contentList:{type:Array},rootPath:{type:String}},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},mounted:function(){},beforeDestroy:function(){},computed:{},methods:{handleScroll:function(t){},computeStyleObj:function(t){var e={};return t["width"]&&(e["width"]=t["width"]+"px"),e},rowClick:function(t){this.$store.commit("SET_SELECTED_SHOW_SYMBOL",t.instrument_id),"FUTURE"===t.class?this.$store.commit("SET_SELECTED_SYMBOL",t.instrument_id):"FUTURE_CONT"===t.class&&this.$store.commit("SET_SELECTED_SYMBOL",t.underlying_symbol),this.selectedSymbol=t.instrument_id},rowDbClick:function(t){this.$router.push({name:"charts",params:{instrument_id:t.instrument_id}})},cellStyle:function(t){var e=t.row,i=t.column;t.rowIndex,t.columnIndex;return["最新价","涨跌","涨跌幅","今开盘","最高价","最低价"].includes(i.label)&&e.change%1===0&&0!==e.change?{color:e.change>0?"red":"green"}:{color:"black"}}}},x=S,E=(i("ab6f"),Object(c["a"])(x,_,g,!1,null,null,null)),D=E.exports,q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.quote?i("div",{staticClass:"quoteinfo-container"},[i("Row",[i("Col",{attrs:{span:"12"}},[i("div",[t._v(t._s(t.quote.ins_name))])]),i("Col",{attrs:{span:"12"}},[i("div",[t._v(t._s(t.instrumentId))])])],1),i("div",{staticClass:"contrast"},[i("Row",[i("Col",{attrs:{span:"6"}},[i("div",[t._v("卖一")])]),i("Col",{attrs:{span:"6"}},[i("div",[t._v(t._s(t.formatter(t.quote.ask_price1)))])]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.quote.ask_volume1)+"\n\t\t\t")]),i("Col",{attrs:{span:"6"}})],1),i("div",{staticClass:"outer"},[i("div",{staticClass:"inner",style:{width:100*t.innerWidth+"%"}})]),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t\t买一\n\t\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.formatter(t.quote.bid_price1)))]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.quote.bid_volume1))]),i("Col",{attrs:{span:"6"}})],1)],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t最新价\n\t\t")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.formatter(t.quote.last_price))+"\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t昨结算\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.formatter(t.quote.pre_settlement))+"\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t涨跌\n\t\t")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.formatter(t.quote.change))+"\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t今开\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.quote.open)+"\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t涨跌幅\n\t\t")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t._f("toPercent")(t.quote.change_percent))+"%\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t最高\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.formatter(t.quote.highest))+"\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t总手\n\t\t")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.quote.volume)+"\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t最低\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.formatter(t.quote.lowest))+"\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t涨停\n\t\t")]),i("Col",{staticClass:"R",attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.formatter(t.quote.upper_limit))+"\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t收盘\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.formatter(t.quote.close))+"\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t跌停\n\t\t")]),i("Col",{staticClass:"G",attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.formatter(t.quote.lower_limit))+"\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t结算\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t\t"+t._s(t.formatter(t.quote.settlement))+"\n\t\t")])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n\t\t持仓量\n\t\t")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t"+t._s(t.quote.open_interest))]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t日增")]),i("Col",{attrs:{span:"6"}},[t._v("\n\t\t"+t._s(t.quote.open_interest-t.quote.pre_open_interest))])],1)],1):t._e()},O=[],T=i("7618");i("f576");function $(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"number"===typeof t?t.toFixed(e):t}function P(t){var e=null;if("number"===typeof t){e=t>1e12&&t<3e12?new Date(t):new Date(t/1e6);var i=e.getFullYear()+"",n=(e.getMonth()+1+"").padStart(2,"0"),r=(e.getDate()+"").padStart(2,"0"),s=(e.getHours()+"").padStart(2,"0"),a=(e.getMinutes()+"").padStart(2,"0"),o=(e.getSeconds()+"").padStart(2,"0"),c=(e.getMilliseconds()+"").padStart(3,"0");return i+"/"+n+"/"+r+"-"+s+":"+a+":"+o+"."+c}return e}function j(t){switch(t){case"BUY":return"买";case"SELL":return"卖";default:return t}}function M(t){switch(t){case"OPEN":return"开";case"CLOSE":return"平昨";case"CLOSETODAY":return"平今";default:return t}}function I(t,e,i,n){if("object"===Object(T["a"])(t)&&Array.isArray(e)){for(var r=[],s=0;s<e.length;s++){var a=e[s],o="string"===typeof i?i:i(a),c=e[s][o];t.hasOwnProperty(c)&&n(a)?(e[s]=t[c],r.push(c)):e.splice(s--,1)}for(var h in t)if(!r.includes(h)){var l=t[h];n(l)&&e.push(l)}}}var N={data:function(){return{quote:this.$tqsdk.get_quote(this.instrumentId)}},mounted:function(){this.$on("tqsdk:rtn_data",this.update)},watch:{instrumentId:{handler:function(t,e){this.quote=this.$tqsdk.get_quote(t)},immediate:!0}},props:{instrumentId:String},computed:{classOfColor:function(){return this.quote["change"]>0?"R":this.quote["change"]<0?"G":""},innerWidth:function(){return this.quote.bid_volume1/(this.quote.bid_volume1+this.quote.ask_volume1)}},methods:{formatter:function(t){return $(t,this.quote.price_decs)},update:function(){this.quote=this.$tqsdk.get_quote(this.instrumentId),this.$forceUpdate()}}},L=N,A=(i("81e5"),Object(c["a"])(L,q,O,!1,null,"22296bb0",null)),F=A.exports,W=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tickslist-container",style:{height:t.height}},[i("table",[t._m(0),t.quote?i("tbody",t._l(t.ticks,(function(e,n){return i("tr",{key:n},[i("td",[t._v(t._s(e.dt))]),i("td",{class:e.textColor},[t._v(t._s(e.price))]),i("td",{class:e.textColor},[t._v(t._s(e.vol))]),i("td",[t._v(t._s(e.oi))]),i("td",{class:e.textColor},[t._v(t._s(e.msg))])])})),0):t._e()])])},R=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("tr",[i("td",[t._v("时间")]),i("td",[t._v("价位")]),i("td",[t._v("现手")]),i("td",[t._v("增仓")]),i("td",[t._v("开平")])])])}],H={data:function(){return{ticks:[],quote:this.$tqsdk.get_quote(this.instrument_id)}},mounted:function(){this.$on("tqsdk:rtn_data",(function(){var t=this.$tqsdk.dm.getTicks(this.instrumentId);t.last_id>0&&this.update()}))},watch:{instrumentId:{handler:function(t,e){this.$tqsdk.set_chart({chart_id:"ticks_chart",symbol:t,duration:0}),this.quote=this.$tqsdk.get_quote(t),this.ticks.splice(0)},immediate:!0}},props:{instrumentId:String,height:String},methods:{genOneTick:function(t,e){var i=e[t],n=e[t-1];if(this.quote&&i&&n&&i.volume-n.volume>0){var r=i.volume-n.volume,s=i.open_interest-n.open_interest,a={datetime:i.datetime,dt:P(i.datetime).slice(11,19),price:$(i.last_price,this.quote.price_decs),vol:r,oi:s,msg:"",textColor:""},o=i.last_price-n.last_price,c=0;switch(c=i.last_price>=n.ask_price1?1:i.last_price<=n.bid_price1?-1:o>0?1:o<0?-1:0,a.msg=s>0&&s===r?"双开":s<0&&s+r===0?"双平":0===c?"换手":(c>0?"多":"空")+(s>0?"开":s<0?"平":"换"),a.msg){case"双开":case"双平":a.textColor=1===c?"R":-1===c?"G":"";break;case"多开":case"多换":case"空平":a.textColor="R";break;case"空开":case"空换":case"多平":a.textColor="G";break;default:a.textColor="";break}return a}return null},update:function(){var t=this.$tqsdk.dm.getTicks(this.instrumentId),e=50,i=0;if(0===this.ticks.length){this.last_id=t.last_id;for(var n=t.last_id;n>=0;n--){var r=this.genOneTick(n,t);if(null!==r&&(this.$set(this.ticks,i,r),i++,i===e))break}}else if(this.last_id<t.last_id){var s=this.genOneTick(t.last_id,t);null!==s&&s.datetime>this.ticks[0].datetime&&this.ticks.splice(0,0,s)}}}},G=H,B=(i("c43b"),Object(c["a"])(G,W,R,!1,null,"06d3a3b2",null)),U=B.exports,z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Split",{staticClass:"split-container",model:{value:t.this_split,callback:function(e){t.this_split=e},expression:"this_split"}},[i("div",{staticClass:"split-pane left",attrs:{slot:"left"},slot:"left"},[t._t("left")],2),i("div",{staticClass:"split-vertical",attrs:{slot:"trigger"},slot:"trigger"},[i("div",{staticClass:"split-vertical-dots"},[i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"})])]),i("div",{staticClass:"split-pane right",attrs:{slot:"right"},slot:"right"},[t._t("right")],2)])},Y=[],Z={data:function(){return{this_split:.5}},created:function(){this.this_split=this.split},props:{split:{type:Number}}},Q=Z,X=(i("966f"),Object(c["a"])(Q,z,Y,!1,null,null,null)),K=X.exports,J=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row"},[i("div",t._l(t.tags,(function(e,n){return i("div",{key:n,staticClass:"col"},[i("Button",{attrs:{size:"small",type:t.type(e)},on:{click:function(i){return t.handlerClickTag(e)}}},[t._v("\n\t\t\t\t"+t._s(e)+"\n\t\t\t")])],1)})),0)])},V=[],tt={name:"ButtonsLine",data:function(){return{selectedTag:this.defaultTag?this.defaultTag:this.tags[0]}},props:{tags:{type:Array,required:!0,validator:function(t){return t.length>0}},defaultTag:String},methods:{type:function(t){return t===this.selectedTag?"primary":"default"},handlerClickTag:function(t){this.selectedTag=t,this.$emit("change",t)}}},et=tt,it=(i("f6ee"),Object(c["a"])(et,J,V,!1,null,"005d704c",null)),nt=it.exports,rt={bid:"快期模拟"};var st=[{name:"合约代码",prop:"instrument_id",width:80},{name:"合约中文名",prop:"ins_name",width:70},{name:"最新价",prop:"last_price",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""},formatter:function(t){return $(t["last_price"],t["price_decs"])}},{name:"买价",prop:"bid_price1",width:60,className:"col-buy",formatter:function(t){return $(t["bid_price1"],t["price_decs"])}},{name:"买量",prop:"bid_volume1",width:60,className:"col-buy"},{name:"卖价",prop:"ask_price1",width:60,className:"col-sell",formatter:function(t){return $(t["ask_price1"],t["price_decs"])}},{name:"卖量",prop:"ask_volume1",width:60,className:"col-sell"},{name:"涨跌",prop:"change",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""},formatter:function(t){return $(t["change"],t["price_decs"])}},{name:"涨跌幅",prop:"change_percent",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""},formatter:function(t){var e=$(t["change"]/t["pre_settlement"]*100,2);return isNaN(e)?"-":e+"%"}},{name:"成交量",prop:"volume",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""}},{name:"持仓量",prop:"open_interest",width:60},{name:"涨停价",prop:"upper_limit",width:60,formatter:function(t){return $(t["upper_limit"],t["price_decs"])}},{name:"跌停价",prop:"lower_limit",width:60,formatter:function(t){return $(t["lower_limit"],t["price_decs"])}},{name:"今开盘",prop:"open",width:60,formatter:function(t){return $(t["open"],t["price_decs"])}},{name:"最低价",prop:"lowest",width:60,formatter:function(t){return $(t["lowest"],t["price_decs"])}},{name:"最高价",prop:"highest",width:60,formatter:function(t){return $(t["highest"],t["price_decs"])}},{name:"昨收盘",prop:"pre_close",width:60,formatter:function(t){return $(t["pre_close"],t["price_decs"])}},{name:"昨结算",prop:"pre_settlement",width:60,formatter:function(t){return $(t["pre_settlement"],t["price_decs"])}},{name:"行情更新时间",prop:"datetime",width:80,formatter:function(t){return t["datetime"]?t["datetime"].slice(11,19):""}},{name:"合约乘数",prop:"volume_multiple",width:60},{name:"最小价位",prop:"price_tick",width:60},{name:"最后交易日",prop:"expire_datetime",width:70,formatter:function(t){return t["expire_datetime"]?P(1e3*t["expire_datetime"]).slice(0,10):""}}];function at(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ot(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?at(Object(i),!0).forEach((function(e){Object(p["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):at(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var ct={name:"quotes",components:{TableQuotes:D,QuoteInfo:F,TicksList:U,SplitLeftRight:K,ButtonsLine:nt},data:function(){var t=this.$route.params.tag;return{defaultTag:t,tags:this.$store.state.tags,quotesTableRow:st,rootPath:"quotes/",selectedTab:"quoteInfo"}},computed:ot({quotesList:function(){var t=this.$store.state.tagsQuotesMap[this.$route.params.tag];return t&&this.$tqsdk.subscribe_quote(t),t},rowWidth:function(){var t=this.$store.state.tags.join("").length,e=this.$store.state.tags.length;return 12.5*t+20*e}},Object(f["b"])({instrumentId:"getSelectedShowInstrumentId"})),methods:{handlerChangeTag:function(t){this.$router.replace({name:"quotes",params:{tag:t}})}}},ht=ct,lt=(i("22eb"),Object(c["a"])(ht,d,m,!1,null,"9e0a58f6",null)),ut=lt.exports,dt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"100%"}},[i("confirm"),t.$store.state.logined?i("trade"):i("login")],1)},mt=[],pt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-trade"},[i("SplitLeftRight",{attrs:{split:t.split}},[i("template",{slot:"left"},[i("Form",{attrs:{"label-width":60}},[i("FormItem",{attrs:{label:"合约"}},[i("AutoComplete",{staticStyle:{width:"200px"},attrs:{clearable:"",data:t.searchResult,placeholder:"请输入合约"},on:{"on-search":t.querySearch},model:{value:t.instrumentId,callback:function(e){t.instrumentId=e},expression:"instrumentId"}})],1),i("FormItem",{attrs:{label:"手数"}},[i("InputNumber",{staticStyle:{width:"200px"},attrs:{min:1},model:{value:t.volume,callback:function(e){t.volume=e},expression:"volume"}})],1),i("FormItem",{attrs:{label:"价格"}},[i("InputNumber",{staticStyle:{width:"200px"},attrs:{max:t.maxPrice,min:t.minPrice,step:t.priceTick},model:{value:t.limitPrice,callback:function(e){t.limitPrice=e},expression:"limitPrice"}})],1),i("FormItem",[i("Button",{on:{click:function(e){return t.insertOrder("BUY","OPEN")}}},[t._v("买开")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.insertOrder("SELL","OPEN")}}},[t._v("卖开")])],1),i("FormItem",[i("Button",{on:{click:function(e){return t.insertOrder("BUY","CLOSE")}}},[t._v("买平")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.insertOrder("SELL","CLOSE")}}},[t._v("卖平")])],1)],1)],1),i("template",{slot:"right"},[i("Tabs",{attrs:{type:"card",animated:!1},model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[i("TabPane",{attrs:{label:"账户",name:"accounts"}},[i("table-accounts")],1),i("TabPane",{attrs:{label:"持仓",name:"positions"}},[i("table-positions",{attrs:{height:t.height}})],1),i("TabPane",{attrs:{label:"委托单",name:"orders"}},[i("table-orders",{attrs:{height:t.height}})],1),i("TabPane",{attrs:{label:"成交记录",name:"trades"}},[i("table-trades",{attrs:{height:t.height}})],1)],1)],1)],2)],1)},ft=[],_t=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"accounts-container"},[i("Table",{attrs:{columns:t.columns1,data:[t.account]}}),i("Table",{attrs:{columns:t.columns2,data:[t.account]}})],1)},gt=[],vt={data:function(){var t={balance:"账户权益",available:"可用资金",pre_balance:"账户权益",deposit:"入金金额",withdraw:"出金金额",commission:"手续费",premium:"权利金",static_balance:"静态权益",position_profit:"持仓盈亏",float_profit:"浮动盈亏",risk_ratio:"风险度",margin:"占用资金",frozen_margin:"冻结保证金",frozen_commission:"冻结手续费",frozen_premium:"冻结权利金",close_profit:"平仓盈亏"};return{columns1:[{title:t["balance"],key:"balance",align:"right",render:function(t,e){return t("div",$(e.row.balance))}},{title:t["available"],key:"available",align:"right",render:function(t,e){return t("div",$(e.row.available))}},{title:t["pre_balance"],key:"pre_balance",align:"right",render:function(t,e){return t("div",$(e.row.pre_balance))}},{title:t["deposit"],key:"deposit",align:"right",render:function(t,e){return t("div",$(e.row.deposit))}},{title:t["withdraw"],key:"withdraw",align:"right",render:function(t,e){return t("div",$(e.row.withdraw))}},{title:t["commission"],key:"commission",align:"right",render:function(t,e){return t("div",$(e.row.commission))}}],columns2:[{title:t["static_balance"],key:"static_balance",align:"right",render:function(t,e){return t("div",$(e.row.static_balance))}},{title:t["position_profit"],key:"position_profit",align:"right",render:function(t,e){return t("div",$(e.row.position_profit))}},{title:t["float_profit"],key:"float_profit",align:"right",render:function(t,e){return t("div",$(e.row.float_profit))}},{title:t["close_profit"],key:"close_profit",align:"right",render:function(t,e){return t("div",$(e.row.close_profit))}},{title:t["margin"],key:"margin",align:"right",render:function(t,e){return t("div",$(e.row.margin))}},{title:t["risk_ratio"],key:"risk_ratio",align:"right",render:function(t,e){return t("div",$(e.row.risk_ratio)+"%")}}]}},created:function(){this.account=this.$tqsdk.get_account(),this.$on("tqsdk:rtn_data",(function(){this.$tqsdk.is_changed(this.account)&&this.$forceUpdate()}))}},bt=vt,yt=(i("0fd9"),Object(c["a"])(bt,_t,gt,!1,null,"6294e21c",null)),wt=yt.exports,kt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{attrs:{height:t.height,columns:t.columns,data:t.positionsArr}})},Ct=[],St={data:function(){return{positionsArr:[],columns:[{title:"合约代码",key:"instrument_id",width:80,fixed:"left"},{title:"最新价",key:"last_price",width:80,align:"right",fixed:"left"},{title:"多仓",key:"volume_long",width:50,align:"right",className:"col-buy"},{title:"开仓均价",key:"open_price_long",width:80,align:"right",className:"col-buy",render:this.formatterPrice},{title:"持仓盈亏",key:"position_profit_long",width:80,align:"right",className:"col-buy",render:this.formatterPrice},{title:"操作",key:"action",width:150,align:"center",className:"col-buy",render:this.genButtons},{title:"空仓",key:"volume_short",width:50,align:"right",className:"col-sell"},{title:"开仓均价",key:"open_price_short",width:80,align:"right",className:"col-sell",render:this.formatterPrice},{title:"持仓盈亏",key:"position_profit_short",width:80,align:"right",className:"col-sell",render:this.formatterPrice},{title:"操作",key:"action",width:150,align:"center",className:"col-sell",render:this.genButtons},{title:"持仓占用",key:"margin",width:80,align:"right",render:this.formatterPrice}]}},props:{height:{type:String},loading:{type:Boolean,default:!1}},mounted:function(){this.$on("tqsdk:rtn_data",(function(){var t=this.$tqsdk.get_positions();t&&this.$tqsdk.is_changed(t)&&I(t,this.positionsArr,(function(t){return["exchange_id"]+"."+t["instrument_id"]}),(function(t){return t.volume_long>0||t.volume_short>0}))}))},methods:{formatterPrice:function(t,e){return t("div",$(e.row[e.column.key]))},genButtons:function(t,e){var i=this,n="col-buy"===e.column.className?"success":"error",r="col-buy"===e.column.className?"SELL":"BUY",s="col-buy"===e.column.className?e.row.volume_long:e.row.volume_short,a=[t("Button",{props:{type:n,size:"small"},style:{marginRight:"5px"},on:{click:function(){i.handleClose(e.index,e.row,r)}}},"平仓"),t("Button",{props:{type:n,size:"small"},style:{marginRight:"5px"},on:{click:function(){i.handleCloseOpen(e.index,e.row,r)}}},"反手")];return t("div",s>0?a:[])},handleClose:function(t,e,i){var n="BUY"===i?e.volume_short:e.volume_long;this.$tqsdk.insert_order({exchange_id:e.exchange_id,ins_id:e.instrument_id,direction:i,offset:"CLOSE",limit_price:e.last_price,volume:n})},handleCloseOpen:function(t,e,i){var n="BUY"===i?e.volume_short:e.volume_long;this.$tqsdk.insert_order({exchange_id:e.exchange_id,ins_id:e.instrument_id,direction:i,offset:"CLOSE",limit_price:e.last_price,volume:n}),this.$tqsdk.insert_order({exchange_id:e.exchange_id,ins_id:e.instrument_id,direction:i,offset:"OPEN",limit_price:e.last_price,volume:n})},rowClick:function(t,e,i){var n=t.exchange_id+"."+t.instrument_id;this.$store.commit("SET_SELECTED_SYMBOL",n)}}},xt=St,Et=Object(c["a"])(xt,kt,Ct,!1,null,null,null),Dt=Et.exports,qt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{attrs:{height:t.height,columns:t.columns,data:t.ordersArr}})},Ot=[],Tt={data:function(){var t=this;return{ordersArr:[],columns:[{title:"委托单ID",key:"order_id",width:180,fixed:"left"},{title:"合约代码",key:"instrument_id",width:70,align:"center"},{title:"方向",key:"direction",width:50,align:"center",render:function(t,e){return t("div",j(e.row.direction))}},{title:"开平",key:"offset",width:50,align:"center",render:function(t,e){return t("div",M(e.row.offset))}},{title:"手数",key:"volume_orign",width:50,align:"right"},{title:"价格",key:"limit_price",width:70,align:"right"},{title:"未成交",key:"volume_left",width:60,align:"right"},{title:"操作",key:"action",width:80,align:"center",render:function(e,i){var n=e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleCancelOrder(i.index,i.row)}}},"撤单");return"ALIVE"===i.row.status?e("div",[n]):e("div",[])}},{title:"状态",key:"status",width:100,align:"center",render:function(t,e){return"FINISHED"===e.row.status?t("div","已完成"):t("div","未完成")}},{title:"下单时间",key:"insert_date_time",width:160,align:"right",render:function(t,e){return t("div",P(e.row.insert_date_time))}},{title:"提示",key:"last_msg",width:180,align:"right"}]}},props:{height:{type:String}},mounted:function(){this.$on("tqsdk:rtn_data",(function(){var t=this.$tqsdk.get_orders();this.$tqsdk.is_changed(t)&&I(t,this.ordersArr,"order_id",(function(){return 1}))}))},methods:{filterStatus:function(t,e){return e.status===t},handleCancelOrder:function(t,e){this.$tqsdk.cancel_order(e.order_id)},rowClick:function(t,e,i){var n=t.exchange_id+"."+t.instrument_id;this.$store.commit("SET_SELECTED_SYMBOL",n)}}},$t=Tt,Pt=Object(c["a"])($t,qt,Ot,!1,null,null,null),jt=Pt.exports,Mt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{attrs:{height:t.height,columns:t.columns,data:t.tradesArr}})},It=[],Nt={data:function(){return{tradesArr:[],columns:[{title:"委托单ID",key:"order_id",width:180,fixed:"left"},{title:"交易所单号",key:"exchange_trade_id",width:100,align:"left"},{title:"合约代码",key:"instrument_id",width:100,align:"left"},{title:"方向",key:"direction",width:50,align:"center",render:function(t,e){return t("div",j(e.row.direction))}},{title:"开平",key:"offset",width:50,align:"center",render:function(t,e){return t("div",M(e.row.offset))}},{title:"手数",key:"volume",width:50,align:"right"},{title:"价格",key:"price",width:70,align:"right",render:function(t,e){return t("div",$(e.row.price))}},{title:"时间",key:"trade_date_time",width:160,align:"right",render:function(t,e){return t("div",P(e.row.trade_date_time))}},{title:"手续费",key:"commission",width:80,align:"right"}]}},props:{height:{type:String}},mounted:function(){this.$on("tqsdk:rtn_data",(function(){var t=this.$tqsdk.get_trades();this.$tqsdk.is_changed(t)&&I(t,this.tradesArr,"trade_id",(function(){return 1}))}))},methods:{filterInstrumentId:function(t,e){return e.instrument_id===t}}},Lt=Nt,At=Object(c["a"])(Lt,Mt,It,!1,null,null,null),Ft=At.exports,Wt={components:{TableAccounts:wt,TablePositions:Dt,TableOrders:jt,TableTrades:Ft,SplitLeftRight:K},data:function(){return{split:.3,instrumentId:"",searchResult:[],selectedTab:"accounts",volume:1,priceTick:1,limitPrice:0,priceDecs:0,maxPrice:1/0,minPrice:0}},mounted:function(){var t=this;this.$store.subscribe((function(e,i){if("SET_SELECTED_SYMBOL"===e.type){var n=t.$tqsdk.get_quote(e.payload);t.instrumentId=e.payload,n&&(t.priceTick=Number(n.price_tick),t.limitPrice=Number(n.last_price),t.priceDecs=Number(n.price_decs),t.maxPrice=0===n.upper_limit?1/0:Number(n.upper_limit),t.minPrice=0===n.lower_limit?0:Number(n.lower_limit))}}))},computed:{height:function(){return this.$root.windowHeight*(1-this.$root.appSplit)-44+""}},methods:{querySearch:function(t,e){this.$tqsdk.quotesInfo.hasOwnProperty(t)?this.searchResult=null:this.searchResult=this.$tqsdk.get_quotes_by_input(t)},handleSelectInstrument:function(t){},insertOrder:function(t,e){var i=this.$tqsdk.get_quote(this.instrumentId);this.$tqsdk.insert_order({exchange_id:i.exchange_id,ins_id:i.ins_id,direction:t,offset:e,limit_price:this.limitPrice,volume:this.volume})}}},Rt=Wt,Ht=(i("e86d"),Object(c["a"])(Rt,pt,ft,!1,null,null,null)),Gt=Ht.exports,Bt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-login"},[t.showLoginError?i("Alert",{attrs:{type:"error","show-icon":"",closable:""},on:{"on-close":t.onclose}},[t._v("\n\t\t"+t._s(t.errorMsg)+"\n\t")]):t._e(),i("Form",{ref:"userForm",attrs:{model:t.userForm,rules:t.rules,"label-width":80}},[i("FormItem",{attrs:{label:"期货公司",prop:"bid"}},[i("Select",{model:{value:t.userForm.bid,callback:function(e){t.$set(t.userForm,"bid",e)},expression:"userForm.bid"}},t._l(t.brokers,(function(e){return i("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),i("FormItem",{attrs:{label:"账号",prop:"user_name"}},[i("Input",{attrs:{placeholder:"请输入账号"},model:{value:t.userForm.user_name,callback:function(e){t.$set(t.userForm,"user_name",e)},expression:"userForm.user_name"}})],1),i("FormItem",{attrs:{label:"密码",prop:"password"}},[i("Input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.userForm.password,callback:function(e){t.$set(t.userForm,"password",e)},expression:"userForm.password"}})],1),i("FormItem",[i("Button",{attrs:{loading:t.loading,type:"primary"},on:{click:function(e){return t.onSubmit("userForm")}}},[t._v("\n\t\t\t\t登录\n\t\t\t")])],1)],1)],1)},Ut=[],zt="等待回应超时,可能的原因 (1)服务器正在运维，(2)网络不通，无法连接服务器，请稍后/检查网络后重试。",Yt={name:"userLogin",data:function(){return{brokers:[],errorMsg:zt,userForm:Object.assign({bid:"",user_name:"",password:""},rt),rules:{bid:[{required:!0,message:"请选择期货公司",trigger:"blur"}],user_name:[{required:!0,message:"请输入账户",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},loading:!1,showLoginError:!1}},mounted:function(){this.$on("tqsdk:rtn_brokers",(function(t){this.brokers=t}))},methods:{onclose:function(){this.showLoginError=!1},onSubmit:function(t){var e=this;this.loading=!0,this.$refs[t].validate((function(t){if(t){e.$tqsdk.login({bid:e.userForm.bid,user_id:e.userForm.user_name,password:e.userForm.password});var i=setTimeout(function(){this.$tqsdk.is_logined()||(this.loading=!1,this.showLoginError=!0,this.errorMsg=zt)}.bind(e),1e4);e.$on("tqsdk:rtn_data",(function(){this.$tqsdk.is_logined()&&(this.loading=!1,this.showLoginError=!1,this.$store.commit("SET_LOGIN",!0),clearTimeout(i))})),e.$on("tqsdk:notify",(function(t){"WARNING"!==t.level&&"ERROR"!==t.level||(this.loading=!1,this.showLoginError=!0,this.errorMsg=t.content)}))}}))}}},Zt=Yt,Qt=(i("55b5"),Object(c["a"])(Zt,Bt,Ut,!1,null,null,null)),Xt=Qt.exports,Kt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",{attrs:{title:"确认结算单",closable:!1,"mask-closable":!1},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[i("div",{staticClass:"confirm-container"},[i("pre",[t._v(t._s(t.confirmContent))])]),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary"},on:{click:t.clickOk}},[t._v("确定")])],1)])},Jt=[],Vt={computed:{visible:function(){return"doing"===this.$store.state.confirm},confirmContent:function(){return this.$store.state.confirmContent}},methods:{clickOk:function(){this.$tqsdk.confirm_settlement(),this.$store.commit("SET_SETTLEMENT",{confirm:"done",confirmContent:""})}}},te=Vt,ee=(i("29f3"),Object(c["a"])(te,Kt,Jt,!1,null,"1eac7c78",null)),ie=ee.exports,ne={name:"user",components:{Trade:Gt,Login:Xt,Confirm:ie}},re=ne,se=Object(c["a"])(re,dt,mt,!1,null,null,null),ae=se.exports,oe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"charts-container"},[i("Chart",{attrs:{instrumentId:t.instrumentId,height:t.height}})],1)},ce=[],he=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chart",style:{height:t.height+"px"}},[i("Tooltip",{attrs:{content:"返回(Esc)",placement:"right-end"}},[i("Button",{attrs:{shape:"circle",icon:"md-return-left"},on:{click:t.goBack}})],1),t._v("\n\n\t \n\n\t"),i("RadioGroup",{attrs:{size:"small",type:"button"},model:{value:t.selectedPeriod,callback:function(e){t.selectedPeriod=e},expression:"selectedPeriod"}},t._l(t.periods,(function(e){return i("Radio",{key:e,attrs:{label:e}},[t._v("\n\t\t\t"+t._s(e)+"\n\t\t")])})),1),t._v("\n\t \n\t"),i("Checkbox",{attrs:{label:"ma"},on:{"on-change":function(e){return t.onchange("ma3")}},model:{value:t.indicators.ma3.show,callback:function(e){t.$set(t.indicators.ma3,"show",e)},expression:"indicators.ma3.show"}},[t._v("MA3")]),i("Checkbox",{attrs:{label:"ma"},on:{"on-change":function(e){return t.onchange("ma10")}},model:{value:t.indicators.ma10.show,callback:function(e){t.$set(t.indicators.ma10,"show",e)},expression:"indicators.ma10.show"}},[t._v("MA10")]),i("Checkbox",{attrs:{label:"ma"},on:{"on-change":function(e){return t.onchange("ma30")}},model:{value:t.indicators.ma30.show,callback:function(e){t.$set(t.indicators.ma30,"show",e)},expression:"indicators.ma30.show"}},[t._v("MA30")]),i("Checkbox",{attrs:{label:"boll"},on:{"on-change":function(e){return t.onchange("boll")}},model:{value:t.indicators.boll.show,callback:function(e){t.$set(t.indicators.boll,"show",e)},expression:"indicators.boll.show"}},[t._v("BOLL")]),i("Dropdown",{on:{"on-click":t.onSelectedItem}},[i("a",{attrs:{href:"javascript:void(0)"}},[t._v("\n\t\t\tK线样式("+t._s(t.selectedItem)+")\n\t\t\t"),i("Icon",{attrs:{type:"ios-arrow-down"}})],1),i("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[i("DropdownItem",{attrs:{name:"candle",selected:"candle"===t.selectedItem}},[t._v("Candles")]),i("DropdownItem",{attrs:{name:"ohlc",selected:"ohlc"===t.selectedItem}},[t._v("Bars")])],1)],1),i("div",{ref:"CHART",style:{height:t.height-30+"px"},attrs:{id:"CHART"}})],1)},le=[],ue=(i("673e"),i("d225")),de=i("b0b4"),me=i("5698"),pe="web_kline_chart",fe=.1,_e=13,ge=55,ve=3,be=function(){function t(e){Object(ue["a"])(this,t),this.tqsdk=e.tqsdk,this.mainType="candle",this._symbol=e.symbol?e.symbol:null,this._duration=e.duration?e.duration:null,this._width=e.width?e.width:null,this._barWidth=_e,this._barPadding=Math.max(1,Math.round(this._barWidth*fe)),this._barNumbers=Math.floor(this._width/this._barWidth),this._left_id=-1,this._right_id=-1,this.sendToServer()}return Object(de["a"])(t,[{key:"resetChartParams",value:function(){this._barNumbers=Math.floor(this._width/this._barWidth),this._barPadding=Math.max(1,Math.round(this._barWidth*fe));var t=this._right_id-this._barNumbers+1;this._left_id=t<0?0:t,this._right_id=this._left_id+this._barNumbers-1,this.sendToServer()}},{key:"get_chart",value:function(t){var e=this.tqsdk.get_by_path("charts/"+pe);if(!e||!e.state||e.state.duration!==this._duration||e.state.ins_list!==this._symbol)return null;switch(t){case"left_id":return e.left_id?e.left_id:-1;case"right_id":return e.right_id?e.right_id:-1;default:return e}}},{key:"get_klines_last_id",value:function(){return this.klines&&this.klines.last_id?this.klines.last_id:-1}},{key:"update",value:function(){if(this.get_klines_last_id()>-1)if("day"===this.mainType)-1===this._left_id||-1===this._right_id?(this._left_id=this.get_chart("left_id"),this._right_id=this.get_klines_last_id()):this._right_id=this.get_klines_last_id(),this._barNumbers=this.get_chart("right_id")-this.get_chart("left_id")+1,this._barWidth=this._width/this._barNumbers;else if(-1===this._left_id||-1===this._right_id){var t=this.get_chart("right_id");t&&t>-1&&(this._right_id=t,this._left_id=this._right_id-this._barNumbers+1)}else this._right_id>=this.klines.last_id-1&&(this._right_id=this._right_id+1===this.klines.last_id?this._right_id+1:this._right_id,this._left_id=this._right_id-this._barNumbers+1)}},{key:"moves",value:function(t){if("day"!==this.mainType&&-1!==this._left_id){var e=this._left_id-t,i=e+this._barNumbers-1;if(e>=0&&e<=this.get_klines_last_id()){var n=[e,i];return this._left_id=n[0],this._right_id=n[1],this.sendToServer(),!0}return!1}}},{key:"sendToServer",value:function(){this._symbol&&this._duration&&("day"===this.mainType?this.tqsdk.set_chart({chart_id:pe,symbol:this._symbol,duration:this._duration,trading_day_start:0}):this._right_id>-1&&this._right_id!==this.get_klines_last_id()?this.tqsdk.set_chart({chart_id:pe,symbol:this._symbol,duration:this._duration,view_width:2*this._barNumbers,left_kline_id:this._left_id-this._barNumbers}):this.tqsdk.set_chart({chart_id:pe,symbol:this._symbol,duration:this._duration,view_width:2*this._barNumbers}))}},{key:"width",set:function(t){this._width=t,this.resetChartParams()}},{key:"barWidth",set:function(t){t=t%2===0?t+1:t,t<ve||t>ge||t===this._barWidth||(this._barWidth=t,this.resetChartParams())},get:function(){return this._barWidth}},{key:"barPadding",get:function(){return this._barPadding}},{key:"barNumbers",get:function(){return this._barNumbers}},{key:"symbol",get:function(){return this._symbol},set:function(t){this._symbol!==t&&(this._symbol=t,this._left_id=this._right_id=-1,this.sendToServer())}},{key:"duration",get:function(){return this._duration},set:function(t){this._duration!==t&&(this._duration=t,this._left_id=this._right_id=-1,this.sendToServer())}},{key:"klinesPath",get:function(){return this.symbol&&this.duration?"klines/"+this.symbol+"/"+this.duration:""}},{key:"quote",get:function(){return this._symbol?this.tqsdk.get_quote(this._symbol):null}},{key:"klines",get:function(){return this._symbol&&this._duration?this.tqsdk.get_klines(this._symbol,this._duration):null}},{key:"left_id",get:function(){return this._left_id}},{key:"right_id",get:function(){return this._right_id}}]),t}(),ye=be,we=me["m"](".%L"),ke=me["m"](":%S"),Ce=me["m"]("%H:%M"),Se=me["m"]("%H:%M"),xe=me["m"]("%m%d"),Ee=me["m"]("%m%d"),De=me["m"]("%y");function qe(t){return(me["q"](t)<t?we:me["o"](t)<t?ke:me["n"](t)<t?Ce:me["l"](t)<t?Se:me["p"](t)<t?xe:me["r"](t)<t?Ee:De)(t)}var Oe={up:function(t){return t.open<=t.close},down:function(t){return t.open>t.close}},Te=Object.keys(Oe),$e={up:function(t){return t.open<t.close},down:function(t){return t.open>t.close},equal:function(t){return t.open===t.close}},Pe=Object.keys($e),je=function(){function t(e){Object(ue["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.chartDm=this.plot.chartDm,this.types=["line","body"]}return Object(de["a"])(t,[{key:"createPaths",value:function(){var t=this;return this.paths=[],Pe.forEach((function(e){return t.paths.push([t.name,"line",e].join("."))})),Pe.forEach((function(e){return t.paths.push([t.name,"body",e].join("."))})),this.paths}},{key:"calcPaths",value:function(t,e,i){var n=this;if(this.plot.yScale&&this.plot.xScale&&this.chartDm){var r={};this.paths.forEach((function(t){return r[t]=""}));for(var s=function(t){if(!i[t])return"continue";Pe.forEach((function(e){$e[e](i[t])&&(r[[n.name,"body",e].join(".")]+=n.bodyPath(i[t],t),r[[n.name,"line",e].join(".")]+=n.linePath(i[t],t))}))},a=t;a<=e;a++)s(a);return r}}},{key:"bodyPath",value:function(t,e){var i=Math.round(this.plot.yScale(t.open)),n=Math.round(this.plot.yScale(t.close)),r=this.plot.xScale(e)+this.chartDm.barPadding,s=this.chartDm.barWidth-2*this.chartDm.barPadding,a="";return a=t.open!==t.close?"M ".concat(r," ").concat(i," L ").concat(r+s," ").concat(i," L ").concat(r+s," ").concat(n," L ").concat(r," ").concat(n," L ").concat(r," ").concat(i):"M ".concat(r," ").concat(i+.5," L ").concat(r+s," ").concat(i+.5),a}},{key:"linePath",value:function(t,e){var i=Math.round(this.plot.yScale(t.high)),n=Math.round(this.plot.yScale(t.low)),r=this.plot.xScale(e)+this.chartDm.barWidth/2,s="M ".concat(r," ").concat(i," L ").concat(r," ").concat(n);return s}}]),t}(),Me=je,Ie=function(){function t(e){Object(ue["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.chartDm=this.plot.chartDm,this.types=["line","body"]}return Object(de["a"])(t,[{key:"createPaths",value:function(){var t=this;return this.paths=[],Pe.forEach((function(e){return t.paths.push([t.name,"body",e].join("."))})),this.paths}},{key:"calcPaths",value:function(t,e,i){var n=this;if(this.plot.yScale&&this.plot.xScale&&this.chartDm){var r={};this.paths.forEach((function(t){return r[t]=""}));for(var s=function(t){if(!i[t])return"continue";Pe.forEach((function(e){$e[e](i[t])&&(r[[n.name,"body",e].join(".")]+=n.bodyPath(i[t],t))}))},a=t;a<=e;a++)s(a);return r}}},{key:"bodyPath",value:function(t,e){var i=this.plot.yScale(t.open),n=this.plot.yScale(t.close),r=this.plot.yScale(t.high),s=this.plot.yScale(t.low),a=this.plot.xScale(e),o=a+this.chartDm.barPadding,c=a+this.chartDm.barWidth/2,h=a+this.chartDm.barWidth-this.chartDm.barPadding,l="M ".concat(o," ").concat(i," L ").concat(c," ").concat(i);return l+="M ".concat(c," ").concat(s," L ").concat(c," ").concat(r),l+="M ".concat(c," ").concat(n," L ").concat(h," ").concat(n),l}}]),t}(),Ne=Ie,Le=function(){function t(e){Object(ue["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.chartDm=this.plot.chartDm}return Object(de["a"])(t,[{key:"createPaths",value:function(){var t=this;return this.paths=[],Te.forEach((function(e){return t.paths.push([t.name,"body",e].join("."))})),this.paths}},{key:"calcPaths",value:function(t,e,i){var n=this;if(this.plot.yScale&&this.plot.xScale&&this.chartDm){var r={};this.paths.forEach((function(t){return r[t]=""}));for(var s=function(t){if(!i[t])return"continue";Te.forEach((function(e){Oe[e](i[t])&&(r[[n.name,"body",e].join(".")]+=n.bodyPath(i[t],t,"up"===e?0:.5))}))},a=t;a<=e;a++)s(a);return r}}},{key:"bodyPath",value:function(t,e,i){var n=Math.floor(this.plot.yScale(0)),r=Math.round(n-this.plot.yScale(t.volume)),s=this.plot.xScale(e)+this.chartDm.barPadding,a=this.chartDm.barWidth-2*this.chartDm.barPadding,o="M ".concat(s+i," ").concat(n-i," L ").concat(s+a-i," ").concat(n-i," L ").concat(s+a-i," ").concat(n-r+i," L ").concat(s+i," ").concat(n-r+i," L ").concat(s+i," ").concat(n-i);return o}}]),t}(),Ae=Le,Fe=function(){function t(e){Object(ue["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.chartDm=this.plot.chartDm}return Object(de["a"])(t,[{key:"createPaths",value:function(){return this.paths=["oi"],this.paths}},{key:"calcPaths",value:function(t,e,i){if(this.plot.yScale&&this.plot.xScale&&this.chartDm){for(var n="",r=t;r<=e;r++)if(i[r]){var s=this.plot.yScale(i[r].close_oi),a=this.plot.xScale(r)+this.chartDm.barWidth/2;n+=""===n?"M":"L",n+="".concat(a," ").concat(s," ")}return{oi:n}}}}]),t}(),We=Fe,Re=function(){function t(e){Object(ue["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.chartDm=this.plot.chartDm}return Object(de["a"])(t,[{key:"createPaths",value:function(){return this.paths=["close"],this.paths}},{key:"calcPaths",value:function(t,e,i){if(this.plot.yScale&&this.plot.xScale&&this.chartDm){for(var n="",r=t;r<=e;r++)if(i[r]){var s=this.plot.yScale(i[r].close),a=this.plot.xScale(r)+this.chartDm.barWidth/2;n+=""===n?"M":"L",n+="".concat(a," ").concat(s," ")}return{close:n}}}}]),t}(),He=Re,Ge=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(ue["a"])(this,t),this.calculator=e.calculator,this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.chartDm=this.plot.chartDm,this.pathClasses=[],this.type="MAIN"}return Object(de["a"])(t,[{key:"createPaths",value:function(){for(var t=this,e=function(e){var i=t.calculator.paths[e].name,n=t.calculator.paths[e].type;"colorBar"===n?Te.forEach((function(e){t.pathClasses.push([t.name,i,e].join("."))})):"candle"===n?["line","body"].forEach((function(e){Pe.forEach((function(n){t.pathClasses.push([t.name,i,e,n].join("."))}))})):t.pathClasses.push([t.name,i].join("."))},i=0;i<this.calculator.paths.length;i++)e(i);return this.pathClasses}},{key:"calcPaths",value:function(e,i,n){var r=this;if(this.plot.yScale&&this.plot.xScale&&this.chartDm){var s={};this.pathClasses.forEach((function(t){return s[t]=""}));for(var a=function(n){var a=r.calculator.paths[n].name,o=r.name+"."+r.calculator.paths[n].name,c=r.calculator.paths[n].type;if("line"===c){for(var h=e;h<=i;h++)if(r.calculator[a][h]){var l=r.linePath(r.calculator[a][h],h);s[o]+=""===s[o]?"M ".concat(l):"L ".concat(l)}}else if("bar"===c){for(var u=r.plot.yScale(0),d=e;d<=i;d++)if(r.calculator[a][d]){var m=r.linePath(r.calculator[a][d],u,d);s[o]+=m}}else"colorBar"===c&&function(){for(var n=r.plot.yScale(0),c=function(e){if(!r.calculator[a][e])return"continue";Te.forEach((function(i){if(i(r.chartDm.klines.data[e])){var c=r.linePath(r.calculator[a][e],n,e,"down"===i?t.HollowBarDiff:0);s[o+"."+i]+=c}}))},h=e;h<=i;h++)c(h)}()},o=0;o<this.calculator.paths.length;o++)a(o);return s}}},{key:"linePath",value:function(t,e){var i=this.plot.yScale(t),n=this.plot.xScale(e)+this.chartDm.barWidth/2;return"".concat(n," ").concat(i)}},{key:"barPath",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=Math.round(e-this.plot.yScale(t)),s=Math.round(this.plot.xScale(i)+this.chartDm.barPadding),a=this.chartDm.barWidth-2*this.chartDm.barPadding;return"M ".concat(s+n," ").concat(e," L ").concat(s+a-n," ").concat(e," L ").concat(s+a-n," ").concat(e-r," L ").concat(s+n," ").concat(e-r," L ").concat(s+n," ").concat(e)}}]),t}();Object(p["a"])(Ge,"HollowBarDiff",.5);var Be=Ge,Ue=function(){function t(e){Object(ue["a"])(this,t),this.id=e.id,this.type=e.type,this.name=e.name,this.xScale=e.xScale,this.yScale=e.yScale,this.chartDm=e.chartDm,this.calculator=e.calculator,this.otherPaths={},this.init()}return Object(de["a"])(t,[{key:"init",value:function(){switch(this.type){case"candle":this.path=new Me({name:this.name,plot:this});break;case"ohlc":this.path=new Ne({name:this.name,plot:this});break;case"day":this.path=new He({name:this.name,plot:this});break;case"volume":this.path=new Ae({name:this.name,plot:this});break;case"oi":this.path=new We({name:this.name,plot:this});break;default:this.path=new Be({calculator:this.calculator,name:this.id,plot:this});break}}},{key:"range",value:function(t,e){var i=this.chartDm.klines.slice(t,e+1);switch(this.type){case"ohlc":case"candle":return[me["h"](i,(function(t){return t&&t["low"]})),me["g"](i,(function(t){return t&&t["high"]}))];case"day":return me["f"](i,(function(t){return t&&t["close"]}));case"volume":return[0,me["g"](i,(function(t){return t&&t["volume"]}))];case"oi":return me["f"](i,(function(t){return t&&t["close_oi"]}));default:return this.path.calculator.calc(t,e,this.chartDm.klines),this.path.calculator.range(t,e)}}},{key:"draw",value:function(){}},{key:"destroy",value:function(){}},{key:"showIndicator",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var i in this.indicators)i===t&&this.g.selectAll("path.".concat(i)).attr("visibility",e?"visible":"hidden")}}]),t}(),ze=Ue,Ye=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.length?t.join(e):""},Ze=function(){function t(e){Object(ue["a"])(this,t),this.xScale=e.xScale,this.chartDm=e.chartDm,this.type=e.type,this.parentG=e.parentG,this.name=e.name,this._height=e.height,this._width=e.width,this._top=e.top?e.top:0,this._left=e.left?e.left:0,this.g=this.parentG.append("g").attr("class",this.name).attr("transform","translate("+this._left+","+this._top+")"),this.yAlign="left"===e.align?"left":"right",this.initYAxis(),this.plots={}}return Object(de["a"])(t,[{key:"initYAxis",value:function(){this.yScale=me["j"]().range([this._height,0]),"left"===this.yAlign?this.yAxis=me["b"]().scale(this.yScale):this.yAxis=me["c"]().scale(this.yScale),this.ySvg=this.g.append("g").attr("class","y axis"),"right"===this.yAlign&&this.ySvg.attr("transform","translate("+this._width+",0)")}},{key:"updateYAxis",value:function(t){this.yScale.domain(t),this.ySvg.call(this.yAxis)}},{key:"top",value:function(t){return t&&(this._top=t,this.g.attr("transform","translate("+this._left+","+this._top+")")),this._top}},{key:"left",value:function(t){return t&&(this._left=t,this.g.attr("transform","translate("+this._left+","+this._top+")")),this.g.left()}},{key:"height",value:function(t){return t&&(this._height=t,this.g.attr("height",this._height),this.yScale.range([this._height,0])),this._height}},{key:"width",value:function(t){return t&&(this._width=t,this.g.attr("width",this._width),"right"===this.yAlign&&this.ySvg.attr("transform","translate("+this._width+",0)")),this._width}},{key:"appendPlotTypePath",value:function(t){Array.isArray(t)||(t=t.split(".")),this.g.selectAll("path.".concat(Ye(t,"."))).data((function(t){return[t]})).enter().append("path").attr("class","".concat(Ye(t," ")))}},{key:"addPlot",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.plots[e.id]=new ze({id:e.id,type:e.type,name:e.name,calculator:e.calculator,xScale:this.xScale,yScale:this.yScale,chartDm:this.chartDm}),this.plots[e.id].path&&this.plots[e.id].path.createPaths().forEach((function(e){t.appendPlotTypePath(e.split("."))}))}},{key:"showPlot",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var i in this.plots)i===t&&this.g.selectAll("path.".concat(i)).attr("visibility",e?"visible":"hidden")}},{key:"removePlot",value:function(t){this.plots[t].destroy(),this.g.selectAll("path.".concat(t)).attr("visibility","hidden"),delete this.plots[t]}},{key:"draw",value:function(t,e){var i=[1/0,-1/0];for(var n in this.plots){var r=this.plots[n],s=r.range(t,e);i[0]=Math.min(s[0],i[0]),i[1]=Math.max(s[1],i[1])}for(var a in this.updateYAxis(i),this.plots)if(!(a in["candle","ohlc","day"]&&a!==this.type)){var o=this.plots[a],c=o.path.calcPaths(t,e,this.chartDm.klines);for(var h in c)this.g.select("path.".concat(h)).attr("d",c[h])}}}]),t}(),Qe=Ze,Xe=function(){function t(e){Object(ue["a"])(this,t),this.parentG=e.parentG,this.name=e.name,this.g=this.parentG.append("g").attr("class",this.name),this._text="正在加载数据",this._isShow=!!e.show&&e.show,this.textG=this.g.append("text").attr("x","50%").attr("y","50%").attr("text-anchor","middle").attr("font-size",50).text(this._text).attr("visibility",this._isShow?"visible":"hidden")}return Object(de["a"])(t,[{key:"show",get:function(){return this._isShow},set:function(t){this._isShow=!!t,this.textG.attr("visibility",this._isShow?"visible":"hidden")}},{key:"text",get:function(){return this._text},set:function(t){this._text=String(t),this.textG.text(this._text)}}]),t}(),Ke=i("768b"),Je=(i("7cdf"),function(t){return Number.isInteger(t)?function(e){return e&&e.toFixed?e.toFixed(t):e}:function(t){return t}}),Ve=function(t){var e=null;if("number"===typeof t){e=t>1e12&&t<3e12?new Date(t):new Date(t/1e6);var i=e.getFullYear()+"",n=(e.getMonth()+1+"").padStart(2,"0"),r=(e.getDate()+"").padStart(2,"0"),s=(e.getHours()+"").padStart(2,"0"),a=(e.getMinutes()+"").padStart(2,"0"),o=(e.getSeconds()+"").padStart(2,"0");(e.getMilliseconds()+"").padStart(3,"0");return"00"===s&&"00"===a&&"00"===o?"".concat(i,"/").concat(n,"/").concat(r," (").concat(e.getDay(),")"):"".concat(i,"/").concat(n,"/").concat(r,"-").concat(s,":").concat(a,":").concat(o)}return e},ti=function(){function t(e){Object(ue["a"])(this,t),this.parentG=e.parentG,this.name=e.name,this._top=e.top?e.top:0,this._left=e.left?e.left:0,this._height=e.height?e.height:0,this._width=e.width?e.width:0,this.chartDm=e.chartDm,this.g=this.parentG.append("g").attr("class",this.name).attr("transform","translate("+this._left+","+this._top+")").attr("height",this._height).attr("width",this._width),this._isShow=!e.show||e.show,this.g.attr("visibility",this._isShow?"visible":"hidden");var i=this;this.g.selectAll("rect").data([0]).enter().append("rect").attr("width",this._width).attr("height",this._height).attr("fill-opacity",0).on("mouseover",(function(){i.show()})).on("mousemove",(function(){var t=me["i"](this),e=Object(Ke["a"])(t,2),n=e[0],r=e[1],s=Math.floor(n/i.chartDm.barWidth),a=s*i.chartDm.barWidth+i.chartDm.barWidth/2;if(i.chartDm.klines){var o=i.chartDm.klines[i.chartDm.left_id+s];if(o){var c=i.chartDm.quote.price_decs,h=Je(c),l=[Ve(o.datetime),"高 "+h(o.high),"开 "+h(o.open),"低 "+h(o.low),"收 "+h(o.close)],u=i.g.selectAll("g.text text"),d=u.selectAll("tspan").data(l);d.exit().remove(),d.enter().append("tspan").merge(d).attr("x","-4em").attr("dy","1em").text((function(t){return t}));var m=i.g.select("g.axisannotation.x text");i.g.select("g.axisannotation.y text");m.text(qe(o.datetime/1e6)),m.attr("x",a).attr("y",i._height+16),i.g.select("g.axisannotation.x rect").attr("x",a).attr("y",i._height+4)}}var p=i.g.select("g.crosshair.horizontal line"),f=i.g.select("g.crosshair.vertical line");p.attr("y1")!==r&&p.attr("y1",r).attr("y2",r),f.attr("x1")!==a&&f.attr("x1",a).attr("x2",a)})).on("mouseleave",(function(){i.hide()})),this.g.append("g").attr("class","crosshair horizontal").append("line").attr("x1",0).attr("y1",0).attr("x2",this._width).attr("y2",0).attr("stroke","#bbbbbb").attr("stroke-dasharray","2 4").attr("visibility","hidden"),this.g.append("g").attr("class","crosshair vertical").append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",this._height).attr("stroke","#bbbbbb").attr("stroke-dasharray","2 4").attr("visibility","hidden"),this.g.append("g").attr("class","text").append("text").attr("fill","grey").attr("x",0).attr("y",0),this.g.append("g").attr("class","axisannotation x"),this.g.select("g.axisannotation.x").append("rect").attr("fill","#eeeeee").attr("opacity","0.8").attr("width","40px").attr("height","16px"),this.g.select("g.axisannotation.x").append("text").attr("fill","white"),this.g.append("g").attr("class","axisannotation y").append("text")}return Object(de["a"])(t,[{key:"top",value:function(t){return t&&(this._top=t,this.g.attr("transform","translate("+this._left+","+this._top+")")),this._top}},{key:"left",value:function(t){return t&&(this._left=t,this.g.attr("transform","translate("+this._left+","+this._top+")")),this._left}},{key:"height",value:function(t){return t&&(this._height=t,this.g.select("g.crosshair.vertical line").attr("y2",t),this.g.select("rect").attr("height",t)),this._height}},{key:"width",value:function(t){return t&&(this._width=t,this.g.select("g.crosshair.horizontal line").attr("x2",t),this.g.select("rect").attr("width",t)),this._width}},{key:"show",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.g.selectAll("g.crosshair line").attr("visibility",t?"visible":"hidden")}},{key:"hide",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.g.selectAll("g.crosshair line").attr("visibility",t?"visible":"hidden")}}]),t}();function ei(t,e,i){for(var n=0,r=i-e+1;r<=i&&!isNaN(n);r++)n+=t[r];return n}function ii(t,e,i,n){return 0!=n.length&&n[t-1]?n[t-1]-e[t-i]/i+e[t]/i:ei(e,i,t)/i}function ni(t,e,i,n){n._s=n._s?n._s:[];var r=0,s=0;if(n._s[t-1])s=n._s[t-1][0]-e[t-i]+e[t],r=n._s[t-1][1]-e[t-i]*e[t-i]+e[t]*e[t];else for(var a=t-i+1;a<=t;a++){var o=e[a];r+=o*o,s+=o}var c=r-s*s/i;c<0&&c>-1e-6&&(c=Math.abs(c));var h=1==i?1:i-1,l=Math.sqrt(c/h);return isNaN(l)||(n._s[t]=[s,r]),l}var ri=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(ue["a"])(this,t),this.params=e.params?e.params:5,this.paths=[{name:"ma",type:"line"}],this.ma=[]}return Object(de["a"])(t,[{key:"calc",value:function(t,e,i){for(var n=t;n<=e;n++)this.ma[n]||(this.ma[n]=ii(n,i.close,this.params,this.ma));return this.ma}},{key:"range",value:function(t,e){for(var i=NaN,n=NaN,r=t;r<=e;r++)this.ma[r]&&(n=n?Math.max(n,this.ma[r]):this.ma[r],i=i?Math.min(i,this.ma[r]):this.ma[r]);return[i,n]}}]),t}(),si=ri,ai=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(ue["a"])(this,t),this.n=e.pramas&&e.pramas.n?e.pramas.n:10,this.p=e.pramas&&e.pramas.p?e.pramas.p:3,this.paths=[{name:"top",type:"line"},{name:"bottom",type:"line"}],this._mid=[],this._std=[],this.top=[],this.bottom=[]}return Object(de["a"])(t,[{key:"calc",value:function(t,e,i){for(var n=t;n<=e;n++)this.top[n]&&this.bottom[n]||(this._mid[n]=ii(n,i.close,this.n,this._mid),this._std[n]=ni(n,i.close,this.n,this._std),this.top[n]=this._mid[n]+this.p*this._std[n],this.bottom[n]=this._mid[n]-this.p*this._std[n]);return{top:this.top,bottom:this.bottom}}},{key:"range",value:function(t,e){for(var i=NaN,n=NaN,r=t;r<=e;r++)this.top[r]&&this.bottom[r]&&(n=n?Math.max(n,this.top[r]):this.top[r],i=i?Math.min(i,this.bottom[r]):this.bottom[r]);return[i,n]}}]),t}(),oi=ai,ci=3,hi=50,li=80,ui=function(){function t(e,i,n){Object(ue["a"])(this,t),this._height=i,this._width=n,this._plotsNumber=e||2,this.positions=[],this.initLayout()}return Object(de["a"])(t,[{key:"initLayout",value:function(){var e=1/this.plotsNumber,i=e+.3*e*(this.plotsNumber-1),n=.7*e,r=this.height-t.PLOT_PADDING*(this.plotsNumber-1);this.positions[0]={width:this._width,height:r*i,top:0};for(var s=1;s<this.plotsNumber;s++)this.positions[s]={width:this._width,height:r*n,top:this.positions[s-1].top+this.positions[s-1].height+t.PLOT_PADDING}}},{key:"width",set:function(t){this._width=t,this.initLayout()},get:function(){return this._width}},{key:"height",set:function(t){this._height=t,this.initLayout()},get:function(){return this._height}},{key:"plotsNumber",set:function(t){this._plotsNumber=t,this.initLayout()},get:function(){return this._plotsNumber}}]),t}();Object(p["a"])(ui,"PLOT_PADDING",2);var di=function(){function t(e){Object(ue["a"])(this,t),this.divDomId=e.id,this.outerWidth=e.width,this.outerHeight=e.height,this.margin=e.margin?e.margin:{top:10,right:50,bottom:30,left:50},this.innerWidth=this.outerWidth-this.margin.left-this.margin.right,this.innerHeight=this.outerHeight-this.margin.top-this.margin.bottom,this._symbol=e.symbol?e.symbol:e.instrumentId?e.instrumentId:"",this._duration=e.duration?e.duration:"",this.chartDm=new ye({tqsdk:e.tqsdk,symbol:this._symbol,duration:this._duration,width:this.innerWidth}),this.init(),this.indicators={},this.plotsManager=new ui(2,this.innerHeight,this.innerWidth),this.mainChart=new Qe({xScale:this.xScale,chartDm:this.chartDm,type:"candle",parentG:this.rootG,width:this.innerWidth,height:this.plotsManager.positions[0].height,top:this.plotsManager.positions[0].top,left:0}),this.mainChart.addPlot({id:"candle",type:"candle",name:"candle"}),this.mainChart.addPlot({id:"ohlc",type:"ohlc",name:"ohlc"}),this.mainChart.addPlot({id:"day",type:"day",name:"day"}),this.mainChart.showPlot("ohlc",!1),this.mainChart.showPlot("day",!1),this.subCharts={volume:new Qe({name:"volume",type:"volume",xScale:this.xScale,chartDm:this.chartDm,parentG:this.rootG,width:this.innerWidth,height:this.plotsManager.positions[1].height,top:this.plotsManager.positions[1].top,left:0}),oi:new Qe({name:"oi",type:"oi",xScale:this.xScale,chartDm:this.chartDm,parentG:this.rootG,align:"left",width:this.innerWidth,height:this.plotsManager.positions[1].height,top:this.plotsManager.positions[1].top,left:0})},this.subCharts["volume"].addPlot({id:"volume",type:"volume",name:"volume"}),this.subCharts["oi"].addPlot({id:"oi",type:"oi",name:"oi"})}return Object(de["a"])(t,[{key:"init",value:function(){this.svg=me["k"]("#"+this.divDomId).append("svg").attr("width",this.outerWidth).attr("height",this.outerHeight),this.rootG=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.loading=new Xe({parentG:this.svg,name:"loading",show:!0}),this.xScale=me["j"](),this.xAxis=me["a"]().scale(this.xScale),this.rootG.append("g").attr("class","x axis").attr("transform","translate("+this.chartDm.barWidth/2+","+(this.innerHeight+.5)+")"),this.crosshair=new ti({parentG:this.svg,name:"crosshair",width:this.innerWidth,height:this.innerHeight,left:this.margin.left,top:this.margin.top,chartDm:this.chartDm});var t=null,e=this,i=me["d"]().on("start",(function(){t=me["e"].x,e.crosshair.hide()})).on("drag",(function(){var i=Math.round((me["e"].x-t)/e.chartDm.barWidth);Math.abs(i)>0&&(t=me["e"].x,e.move(i))})).on("end",(function(){t=null,e.crosshair.show()}));this.svg.call(i);var n=0,r=me["s"]().on("zoom",(function(){if(n+=me["e"].sourceEvent.deltaY,Math.abs(n)>=ci){var t=Math.round(Math.abs(n)/ci);t=n>0?t:-t,e.debounce(e.zoom,200).bind(e)(t),n=0}}));this.svg.call(r).on("dblclick.zoom",null)}},{key:"update",value:function(){this.chartDm.update(),this.draw()}},{key:"width",value:function(t){if(void 0===t)return this.outerWidth;if(t<this.margin.left+this.margin.right+li)return this.outerWidth;for(var e in this.outerWidth=t,this.innerWidth=this.outerWidth-this.margin.left-this.margin.right,this.svg.attr("width",this.outerWidth),this.chartDm.width=this.innerWidth,this.plotsManager.width=this.innerWidth,this.mainChart.width(this.plotsManager.positions[0].width),this.subCharts)this.subCharts[e].width=this.plotsManager.positions[1].width;this.crosshair.width(this.innerWidth)}},{key:"height",value:function(t){if(void 0===t)return this.outerHeight;if(!(t<this.margin.top+this.margin.bottom+hi)){for(var e in this.outerHeight=t,this.innerHeight=this.outerHeight-this.margin.top-this.margin.bottom,this.svg.attr("height",this.outerHeight),this.plotsManager.height=this.innerHeight,this.mainChart.height(this.plotsManager.positions[0].height),this.mainChart.top(this.plotsManager.positions[0].top),this.subCharts)this.subCharts[e].height(this.plotsManager.positions[1].height),this.subCharts[e].top(this.plotsManager.positions[1].top);this.crosshair.height(this.innerHeight)}}},{key:"symbol",value:function(t){if(void 0===t)return this._symbol;this._symbol=t,this.chartDm.symbol=t,setTimeout(this.draw.bind(this),0)}},{key:"duration",value:function(t){if(void 0===t)return this._duration;this._duration=t,this.chartDm.duration=t,setImmediate(this.draw.bind(this))}},{key:"debounce",value:function(t,e){var i=null;return function(){var n=this,r=arguments;clearTimeout(i),i=setTimeout((function(){t.apply(n,r)}),e)}}},{key:"addIndicator",value:function(t){var e=t.id;switch(this.indicators[e]=t,t.name){case"ma":this.indicators[e].calculator=new si(t);break;case"boll":this.indicators[e].calculator=new oi(t);break}this.mainChart.addPlot(this.indicators[e])}},{key:"setMainChartType",value:function(t){this.mainChart.type=t,"day"===t&&(this._duration=6e10,this.chartDm.duration=6e10,setImmediate(this.draw.bind(this)))}},{key:"showPlot",value:function(t){this.mainChart.showPlot(t.id,t.show)}},{key:"move",value:function(t){"day"!==this.mainChart.type&&(this.chartDm.moves(t),this.draw())}},{key:"zoom",value:function(t){var e=this.chartDm.barWidth;this.chartDm.barWidth-=t,e!==this.chartDm.barWidth&&this.draw()}},{key:"drawXAxis",value:function(){this.xScale.domain([this.chartDm.left_id,this.chartDm.right_id]),this.xScale.rangeRound([0,this.chartDm.barNumbers*this.chartDm.barWidth-this.chartDm.barWidth]),this.rootG.selectAll("g.x.axis").attr("transform","translate("+this.chartDm.barWidth/2+","+(this.innerHeight+.5)+")");var t=this.chartDm.klines;this.xAxis.tickFormat((function(e,i){return t[e]&&t[e].datetime?qe(t[e].datetime/1e6):""})),this.rootG.selectAll("g.x.axis").call(this.xAxis)}},{key:"draw",value:function(){if(console.log("draw",this.chartDm.left_id,this.chartDm.right_id),-1===this.chartDm.left_id||-1===this.chartDm.right_id)return!1;for(var t in this.loading.show&&(this.loading.show=!1),this.drawXAxis(),this.mainChart.draw(this.chartDm.left_id,this.chartDm.right_id),this.subCharts)this.subCharts[t].draw(this.chartDm.left_id,this.chartDm.right_id)}}]),t}(),mi=di,pi={"5s":5e9,"1m":6e10,"5m":3e11,"15m":9e11,"30m":18e11,"1H":36e11,"1D":864e11},fi={name:"Chart",data:function(){return{width:this.$root.windowWidth,periods:Object.keys(pi),selectedPeriod:"1m",selectedItem:"candle",indicators:{ma3:{id:"ma3",name:"ma",type:"ma",params:3,show:!0},ma10:{id:"ma10",name:"ma",type:"ma",params:10,show:!0},ma30:{id:"ma30",name:"ma",type:"ma",params:30,show:!0},boll:{id:"boll",name:"boll",type:"boll",params:{n:3,p:5},show:!0}}}},computed:{duration:function(){return pi[this.selectedPeriod]}},props:{instrumentId:{type:String,required:!0,default:"KQ.m@CFFEX.IF"},height:{type:Number,required:!0,default:400}},methods:{onchange:function(t){this.chart.showPlot(this.indicators[t])},onSelectedItem:function(t){this.chart.showPlot({id:this.selectedItem,show:!1}),this.selectedItem=t,this.chart.showPlot({id:t,show:!0})},keyUpHandler:function(t){"Escape"===t.key&&this.$router.go(-1)},goBack:function(){this.$router.go(-1)},update:function(){console.log("vue update"),this.chart&&this.chart.update()}},watch:{instrumentId:{handler:function(t,e){"charts"===this.$route.name&&(this.$tqsdk.subscribe_quote([this.instrumentId]),this.chart&&this.chart.symbol(t))},immediate:!0},duration:{handler:function(t,e){this.chart&&this.chart.duration(t)},immediate:!0},height:{handler:function(t,e){this.chart&&(this.chart.height(this.$refs.CHART.clientHeight),this.chart.draw())},immediate:!0}},beforeDestroy:function(){document.removeEventListener("keyup",this.keyUpHandler,!0)},mounted:function(){document.addEventListener("keyup",this.keyUpHandler,!0),this.$on("tqsdk:rtn_data",this.update),this.$on("global:resize",(function(){this.chart.height(this.$refs.CHART.clientHeight),this.chart.width(this.$refs.CHART.clientWidth),this.chart.draw()})),this.$nextTick((function(){var t=this.$refs.CHART.clientHeight,e=this.$refs.CHART.clientWidth,i={top:20,right:50,bottom:20,left:50};for(var n in this.chart=new mi({id:"CHART",width:e,height:t,margin:i,tqsdk:this.$tqsdk,instrumentId:this.instrumentId,duration:this.duration,mainPlotType:"candle"}),this.indicators)this.chart.addIndicator(this.indicators[n])}))}},_i=fi,gi=(i("cd60"),Object(c["a"])(_i,he,le,!1,null,null,null)),vi=gi.exports,bi={components:{Chart:vi},computed:{instrumentId:function(){return this.$route.params.instrument_id},height:function(){return this.$root.windowHeight*this.$root.appSplit}}},yi=bi,wi=(i("5fc6"),Object(c["a"])(yi,oe,ce,!1,null,"71a3296a",null)),ki=wi.exports,Ci=[{id:"主连",func:function(t){return"FUTURE_CONT"===t.class}},{id:"指数",func:function(t){return"FUTURE_INDEX"===t.class}},{id:"金融",func:function(t){return["IH","IF","IC","T","TF"].includes(t.product_id)||["CFFEX.IH","CFFEX.IF","CFFEX.IC","CFFEX.T","CFFEX.TF"].includes(t.underlying_product)}},{id:"金银",func:function(t){return["au","ag"].includes(t.product_id)||["SHFE.au","SHFE.ag"].includes(t.underlying_product)}},{id:"铜铝铅锌",func:function(t){return["al","cu","ni","pb","sn","zn"].includes(t.product_id)||["SHFE.al","SHFE.cu","SHFE.ni","SHFE.pb","SHFE.sn","SHFE.zn"].includes(t.underlying_product)}},{id:"双焦",func:function(t){return["j","jm"].includes(t.product_id)||["DCE.j","DCE.jm"].includes(t.underlying_product)}},{id:"钢铁",func:function(t){return["SF","SM","hc","i","rb"].includes(t.product_id)||["CZCE.SF","CZCE.SM","SHFE.hc","DCE.i","SHFE.rb"].includes(t.underlying_product)}},{id:"煤炭",func:function(t){return["ZC","j","jm"].includes(t.product_id)||["CZCE.ZC","DCE.j","DCE.jm"].includes(t.underlying_product)}},{id:"化工",func:function(t){return["MA","TA","bu","l","pp","ru","v"].includes(t.product_id)||["CZCE.MA","CZCE.TA","SHFE.bu","DCE.l","DCE.pp","SHFE.ru","DCE.v"].includes(t.underlying_product)}},{id:"油脂",func:function(t){return["OI","p","y"].includes(t.product_id)||["CZCE.OI","DCE.p","DCE.y"].includes(t.underlying_product)}},{id:"软商品",func:function(t){return["CF","CY","SR"].includes(t.product_id)||["CZCE.CF","CZCE.CY","CZCE.SR"].includes(t.underlying_product)}},{id:"谷物",func:function(t){return["JR","LR","RI","WH","a","c"].includes(t.product_id)||["CZCE.JR","CZCE.LR","CZCE.RI","CZCE.WH","DCE.a","DCE.c"].includes(t.underlying_product)}},{id:"农副",func:function(t){return["cs","jd"].includes(t.product_id)||["DCE.cs","DCE.jd"].includes(t.underlying_product)}},{id:"饲料",func:function(t){return["RM","c","m"].includes(t.product_id)||["CZCE.RM","DCE.c","DCE.m"].includes(t.underlying_product)}},{id:"建材",func:function(t){return["FG","rb"].includes(t.product_id)||["CZCE.FG","SHFE.rb"].includes(t.underlying_product)}}],Si={};for(var xi in Ci)Si[Ci[xi].id]=[];var Ei=Ci;n["default"].use(u["a"]);var Di=new u["a"]({routes:[{path:"/quotes/:tag",name:"quotes",components:{quotes:ut,user:ae}},{path:"/charts/:instrument_id",name:"charts",components:{quotes:ki,user:ae}},{path:"/*",redirect:"/quotes/"+Ei[0].id}]}),qi=(i("55dd"),{SET_BROKERS:function(t,e){t.brokers=e},SET_TAGS_QOUTES_MAP:function(t,e){var i={};for(var n in e){var r=e[n];if(!r.expired)for(var s in Ei){var a=Ei[s];a.func(r)&&(i[a.id]?i[a.id].push(n):i[a.id]=[n])}}for(var o in i)i[o].sort((function(t,i){var n=e[t].sort_key-e[i].sort_key;return 0===n?e[t].ins_id-e[i].ins_id:n}));t.tagsQuotesMap=i},SET_LOGIN:function(t,e){t.logined=e},SET_SETTLEMENT:function(t,e){t.confirm="doing",t.confirmContent=e["content"]},SET_WS_CONNECT_STATUS:function(t,e){Object.assign(t,e)},SET_SELECTED_SYMBOL:function(t,e){t.selectSymbol=e},SET_SELECTED_SHOW_SYMBOL:function(t,e){t.selectShowSymbol=e}}),Oi={getSelectedInstrumentId:function(t,e){return t.selectSymbol},getSelectedShowInstrumentId:function(t,e){return t.selectShowSymbol}};n["default"].use(f["a"]);var Ti=new f["a"].Store({state:{bid:"",user_id:"",logined:!1,confirm:"done",confirmContent:"",selectShowSymbol:"KQ.m@CFFEX.IF",selectSymbol:"",quoteWsConnected:!1,tradeWsConnected:!1,ins_list:[],tags:Ei.map((function(t){return t.id})),tagsQuotesMap:Si},mutations:qi,getters:Oi}),$i=Ti,Pi=i("e069"),ji=i.n(Pi);i("dcad");n["default"].use(ji.a,{transfer:!0,size:"small"});i("ffc1"),i("20d6");var Mi=i("01a2"),Ii=i.n(Mi),Ni=new Ii.a({symbolsServerUrl:"https://openmd.shinnytech.com/t/md/symbols/latest.json",wsQuoteUrl:"wss://openmd.shinnytech.com/t/md/front/mobile",wsTradeUrl:"wss://t.shinnytech.com/trade/shinny",reconnectInterval:3e3,reconnectMaxTimes:5,prefix:"web"});window.tqsdk=Ni;var Li=Number(n["default"].version.split(".")[0]),Ai=function(){},Fi={},Wi={},Ri=/^global:/,Hi={},Gi=/^tqsdk:/;function Bi(t){var e=t.prototype.$on,i=t.prototype.$emit;t.prototype.$on=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ai,n=this;if(Array.isArray(t))t.forEach((function(t){return n.$on(t,i)}));else if(Ri.test(t))(Wi[n._uid]||(Wi[n._uid]=[])).push(t),(Fi[t]||(Fi[t]=[])).push(n),e.call(n,t,i);else if(Gi.test(t)){Hi[n._uid]||(Hi[n._uid]={});var r=t.match(/^tqsdk:(.*)/)[1];Hi[n._uid][r]||(Hi[n._uid][r]=[]);var s=i.bind(n);Hi[n._uid][r].push(s),Ni.on(r,s)}else e.call(n,t,i);return n},t.prototype.$emit=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var s=this;if(Ri.test(t)){var a=Fi[t]||[];a.forEach((function(e){return i.apply(e,[t].concat(n))}))}else i.apply(s,[t].concat(n));return s}}function Ui(t){t.mixin({beforeDestroy:function(){var t=this,e=Wi[t._uid]||[];e.forEach((function(e){var i=Fi[e].findIndex((function(e){return e._uid===t._uid}));Fi[e].splice(i,1)})),delete Wi[t._uid];var i=Hi[t._uid]||{},n=function(t){var e=i[t];e.forEach((function(e){Ni.removeEventListener(t,e)}))};for(var r in i)n(r);delete Hi[t._uid],Object.entries(Fi).forEach((function(t){var e=Object(Ke["a"])(t,2),i=e[0],n=e[1];return n.length||delete Fi[i]}))}})}function zi(t){Li<2?console.error("[vue-event-proxy] only support Vue 2.0+"):zi.installed||(zi.installed=!0,Bi(t),Ui(t))}n["default"].use(zi),n["default"].$tqsdk=Ni,n["default"].prototype.$tqsdk=Ni;var Yi=Ni;Yi.on("ready",(function(){$i.commit("SET_TAGS_QOUTES_MAP",Yi.quotesInfo)})),Yi.on("error",(function(){n["default"].prototype.$Message.error("获取合约列表失败，请检查网络后刷新页面。")})),n["default"].config.productionTip=!1,n["default"].config.errorHandler=function(t,e,i){console.error(t,e,i)},n["default"].filter("toPercent",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=Number(t);return Number.isFinite(i)?i.toFixed(e):t}));var Zi={name:"tianqin-web",windowHeight:window.innerHeight,windowWidth:window.innerWidth,appSplit:.6},Qi=new n["default"]({data:Zi,router:Di,store:$i,render:function(t){return t(l)},methods:{handlerResize:function(){Zi.windowHeight=window.innerHeight,Zi.windowWidth=window.innerWidth,this.$emit("global:resize")}},created:function(){var t;function e(){t||(t=setTimeout((function(){t=null,Qi.handlerResize()}),66))}window.addEventListener("resize",e,!1)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var n=i("e332"),r=i.n(n);r.a},"5cb9":function(t,e,i){},"5fc6":function(t,e,i){"use strict";var n=i("4963"),r=i.n(n);r.a},"7dff":function(t,e,i){},"80a6":function(t,e,i){},"81e5":function(t,e,i){"use strict";var n=i("bef1"),r=i.n(n);r.a},"960c":function(t,e,i){},"966f":function(t,e,i){"use strict";var n=i("7dff"),r=i.n(n);r.a},ab6f:function(t,e,i){"use strict";var n=i("960c"),r=i.n(n);r.a},bef1:function(t,e,i){},c43b:function(t,e,i){"use strict";var n=i("3838"),r=i.n(n);r.a},cd60:function(t,e,i){"use strict";var n=i("351d"),r=i.n(n);r.a},e332:function(t,e,i){},e86d:function(t,e,i){"use strict";var n=i("5cb9"),r=i.n(n);r.a},f6ee:function(t,e,i){"use strict";var n=i("551b"),r=i.n(n);r.a}});